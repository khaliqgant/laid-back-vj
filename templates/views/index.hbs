<h1>{{intro}}</h1>

{{#if auth}}
    <div class="auth">
        <a class="spotify-button js-spotify-login">Login With Spotify</a>
        <input type="text" class="service-input js-spotify-input">
        <a class="lastfm-button js-lastfm-login">Login With LastFM</a>
        <input type="text" class="service-input js-last-input">
    </div>
{{/if}}

<!-- 1. The <iframe> (and video player) will replace this <div> tag. -->
<div id="player"></div>
<script>
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    let player;
    window.player = player;

    /**
     * On YouTubeIframeAPIReady
     * @desc
     * bind to the window to make sure it is evoked globally
     * @see https://developers.google.com/youtube/iframe_api_reference
     * @see https://stackoverflow.com/questions/12256382/youtube-iframe-api-not-triggering-onyoutubeiframeapiready
     * https://stackoverflow.com/questions/19732363/youtube-iframe-api-behavior-is-inconsistent-nondeterministic
     */
    function onYouTubeIframeAPIReady () {

        player = new window.YT.Player('player', {
            events: {
                onReady: window.onPlayerReady,
                onStateChange: window.onPlayerStateChange,
            },
            height: '390',
            videoId: window.id !== '' ? window.id : 'M7lc1UVf-VE',
            width: '640',
        });

    };
</script>

{{#if tracks}}
    <div class="tracks">
        {{tracks.artist}} - {{tracks.name}}
    </div>
{{/if}}

<script type="text/javascript">
    var userId = {{{json userId}}};
    var videos = {{{json videos}}};
</script>


